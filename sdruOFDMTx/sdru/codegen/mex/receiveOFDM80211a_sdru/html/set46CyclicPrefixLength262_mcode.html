<div class="dead">
<pre class="code">
<span class="srcline"><span class="lineno"><a href="60,1" id="srcline1">  1</a></span><span class="line"><span class="keyword">classdef</span> (Hidden) OFDMBase &lt; matlab.System &amp; matlab.system.mixin.Propagates</span></span>
<span class="srcline"><span class="lineno"><a href="60,2" id="srcline2">  2</a></span><span class="line">                                       </span></span>
<span class="srcline"><span class="lineno"><a href="60,3" id="srcline3">  3</a></span><span class="line"><span class="comment">%OFDMBase Base object for OFDMModulator and OFDMDemodulator System objects</span></span></span>
<span class="srcline"><span class="lineno"><a href="60,4" id="srcline4">  4</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="60,5" id="srcline5">  5</a></span><span class="line"><span class="comment">% Copyright 2013 The MathWorks, Inc.</span></span></span>
<span class="srcline"><span class="lineno"><a href="60,6" id="srcline6">  6</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="60,7" id="srcline7">  7</a></span><span class="line"><span class="comment">%#codegen</span></span></span>
<span class="srcline"><span class="lineno"><a href="60,8" id="srcline8">  8</a></span><span class="line"><span class="comment">%#ok&lt;*EMCA&gt;</span></span></span>
<span class="srcline"><span class="lineno"><a href="60,9" id="srcline9">  9</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="60,10" id="srcline10"> 10</a></span><span class="line"><span class="keyword">properties</span> (Nontunable)</span></span>
<span class="srcline"><span class="lineno"><a href="60,11" id="srcline11"> 11</a></span><span class="line">    <span class="comment">%FFTLength FFT length</span></span></span>
<span class="srcline"><span class="lineno"><a href="60,12" id="srcline12"> 12</a></span><span class="line">    <span class="comment">% Specify the IFFT length. This property can be set to an integer</span></span></span>
<span class="srcline"><span class="lineno"><a href="60,13" id="srcline13"> 13</a></span><span class="line">    <span class="comment">% scalar. The value must be a power of two. The default value of</span></span></span>
<span class="srcline"><span class="lineno"><a href="60,14" id="srcline14"> 14</a></span><span class="line">    <span class="comment">% this property is 64.</span></span></span>
<span class="srcline"><span class="lineno"><a href="60,15" id="srcline15"> 15</a></span><span class="line">    FFTLength = 64;</span></span>
<span class="srcline"><span class="lineno"><a href="60,16" id="srcline16"> 16</a></span><span class="line">    <span class="comment">%CyclicPrefixLength Cyclic prefix length</span></span></span>
<span class="srcline"><span class="lineno"><a href="60,17" id="srcline17"> 17</a></span><span class="line">    <span class="comment">% Specify the cyclic prefix length. This property can be set to a</span></span></span>
<span class="srcline"><span class="lineno"><a href="60,18" id="srcline18"> 18</a></span><span class="line">    <span class="comment">% non-negative interher scalar. The default value of this property is 16.</span></span></span>
<span class="srcline"><span class="lineno"><a href="60,19" id="srcline19"> 19</a></span><span class="line">    CyclicPrefixLength = 16;</span></span>
<span class="srcline"><span class="lineno"><a href="60,20" id="srcline20"> 20</a></span><span class="line">    <span class="comment">%NumGuardBandCarriers Number of guard bands</span></span></span>
<span class="srcline"><span class="lineno"><a href="60,21" id="srcline21"> 21</a></span><span class="line">    <span class="comment">% Specify the lower and upper guard bands in frequency domain.This</span></span></span>
<span class="srcline"><span class="lineno"><a href="60,22" id="srcline22"> 22</a></span><span class="line">    <span class="comment">% property can be set to a non-nagative two-element vector. </span></span></span>
<span class="srcline"><span class="lineno"><a href="60,23" id="srcline23"> 23</a></span><span class="line">    <span class="comment">% The default setting of this property is [6 5].</span></span></span>
<span class="srcline"><span class="lineno"><a href="60,24" id="srcline24"> 24</a></span><span class="line">    NumGuardBandCarriers = [6; 5];</span></span>
<span class="srcline"><span class="lineno"><a href="60,25" id="srcline25"> 25</a></span><span class="line">    <span class="comment">%NumSymbols Number of OFDM symbols</span></span></span>
<span class="srcline"><span class="lineno"><a href="60,26" id="srcline26"> 26</a></span><span class="line">    <span class="comment">% Specify the number of OFDM symbols at the output. The default value </span></span></span>
<span class="srcline"><span class="lineno"><a href="60,27" id="srcline27"> 27</a></span><span class="line">    <span class="comment">% of this property is 1.</span></span></span>
<span class="srcline"><span class="lineno"><a href="60,28" id="srcline28"> 28</a></span><span class="line">    NumSymbols = 1;</span></span>
<span class="srcline"><span class="lineno"><a href="60,29" id="srcline29"> 29</a></span><span class="line">    <span class="comment">%PilotCarrierIndices Pilot subcarrier indices</span></span></span>
<span class="srcline"><span class="lineno"><a href="60,30" id="srcline30"> 30</a></span><span class="line">    <span class="comment">% Specify the locations where pilots are to be inserted. You can</span></span></span>
<span class="srcline"><span class="lineno"><a href="60,31" id="srcline31"> 31</a></span><span class="line">    <span class="comment">% set this property to a numeric scalar, column vector, matrix, or</span></span></span>
<span class="srcline"><span class="lineno"><a href="60,32" id="srcline32"> 32</a></span><span class="line">    <span class="comment">% 3-D array. The defalut value of the property is [-21; -7; 7; 21].</span></span></span>
<span class="srcline"><span class="lineno"><a href="60,33" id="srcline33"> 33</a></span><span class="line">    PilotCarrierIndices = [12;26;40;54];</span></span>
<span class="srcline"><span class="lineno"><a href="60,34" id="srcline34"> 34</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="60,35" id="srcline35"> 35</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="60,36" id="srcline36"> 36</a></span><span class="line"><span class="keyword">properties</span> (Access = protected)</span></span>
<span class="srcline"><span class="lineno"><a href="60,37" id="srcline37"> 37</a></span><span class="line">    pDataLinearIndices;  <span class="comment">% Nontunable ideally</span></span></span>
<span class="srcline"><span class="lineno"><a href="60,38" id="srcline38"> 38</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="60,39" id="srcline39"> 39</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="60,40" id="srcline40"> 40</a></span><span class="line"><span class="keyword">properties</span> (Access = protected, Nontunable)</span></span>
<span class="srcline"><span class="lineno"><a href="60,41" id="srcline41"> 41</a></span><span class="line">    pPilotLinearIndices;</span></span>
<span class="srcline"><span class="lineno"><a href="60,42" id="srcline42"> 42</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="60,43" id="srcline43"> 43</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="60,44" id="srcline44"> 44</a></span><span class="line"><span class="keyword">methods</span></span></span>
<span class="srcline"><span class="lineno"><a href="60,45" id="srcline45"> 45</a></span><span class="line">  <span class="keyword">function</span> obj = OFDMBase(varargin) <span class="comment">% Constructor</span></span></span>
<span class="srcline"><span class="lineno"><a href="60,46" id="srcline46"> 46</a></span><span class="line">    setProperties(obj, nargin, varargin{:});</span></span>
<span class="srcline"><span class="lineno"><a href="60,47" id="srcline47"> 47</a></span><span class="line">  <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="60,48" id="srcline48"> 48</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="60,49" id="srcline49"> 49</a></span><span class="line">  <span class="keyword">function</span> set.FFTLength(obj, fftLen)</span></span>
<span class="srcline"><span class="lineno"><a href="60,50" id="srcline50"> 50</a></span><span class="line">    propName = <span class="string">'FFTLength'</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="60,51" id="srcline51"> 51</a></span><span class="line"><span class="comment">%     validateattributes(fftLen, {'numeric'}, <span class="keyword">...</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="60,52" id="srcline52"> 52</a></span><span class="line"><span class="comment">%         {'real','scalar','integer','finite','&gt;=',8}, <span class="keyword">...</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="60,53" id="srcline53"> 53</a></span><span class="line"><span class="comment">%         [class(obj) '.' propName], propName);  </span></span></span>
<span class="srcline"><span class="lineno"><a href="60,54" id="srcline54"> 54</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="60,55" id="srcline55"> 55</a></span><span class="line">    log2FFTLen = log2(fftLen);</span></span>
<span class="srcline"><span class="lineno"><a href="60,56" id="srcline56"> 56</a></span><span class="line">    coder.internal.errorIf(log2FFTLen ~= floor(log2FFTLen), <span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="60,57" id="srcline57"> 57</a></span><span class="line">        <span class="string">'comm:OFDM:xxx'</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="60,58" id="srcline58"> 58</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="60,59" id="srcline59"> 59</a></span><span class="line">    obj.FFTLength = fftLen;</span></span>
<span class="srcline"><span class="lineno"><a href="60,60" id="srcline60"> 60</a></span><span class="line">  <span class="keyword">end</span></span></span>
</pre>
</div>
<pre class="code">
<span class="srcline"><span class="lineno"><a href="60,61" id="srcline61"> 61</a></span><span class="line">  </span></span>
<span class="srcline"><span class="lineno"><a href="60,62" id="srcline62"> 62</a></span><span class="line">  <span class="keyword">function</span> set.CyclicPrefixLength(<span class="var type1" id="S25T556U113">obj</span>, <span class="mxinfo" id="T2:U2"><span class="var type1" id="S26T2U114">CPLen</span></span>)</span></span>
<span class="srcline"><span class="lineno"><a href="60,63" id="srcline63"> 63</a></span><span class="line">    <span class="mxinfo" id="T193:U4"><span class="var type1" id="S27T193U117">propName</span> = <span class="mxinfo" id="T193:U6"><span class="string">'CyclicPrefixLength'</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="60,64" id="srcline64"> 64</a></span><span class="line"><span class="comment">%     validateattributes(CPLen, {'numeric'}, <span class="keyword">...</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="60,65" id="srcline65"> 65</a></span><span class="line"><span class="comment">%         {'real','row','integer','nonnegative','finite'}, <span class="keyword">...</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="60,66" id="srcline66"> 66</a></span><span class="line"><span class="comment">%         [class(obj) '.' propName], propName);  </span></span></span>
<span class="srcline"><span class="lineno"><a href="60,67" id="srcline67"> 67</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="60,68" id="srcline68"> 68</a></span><span class="line">    <span class="var type1" id="S25T556U122">obj</span>.CyclicPrefixLength = <span class="var type1" id="S26T2U124">CPLen</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="60,69" id="srcline69"> 69</a></span><span class="line">  <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="60,70" id="srcline70"> 70</a></span><span class="line">    </span></span>
</pre>
<div class="dead">
<pre class="code">
<span class="srcline"><span class="lineno"><a href="60,71" id="srcline71"> 71</a></span><span class="line">  <span class="keyword">function</span> set.NumGuardBandCarriers(obj, guardBands)</span></span>
<span class="srcline"><span class="lineno"><a href="60,72" id="srcline72"> 72</a></span><span class="line">    propName = <span class="string">'NumGuardBandCarriers'</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="60,73" id="srcline73"> 73</a></span><span class="line"><span class="comment">%     validateattributes(guardBands, {'numeric'}, <span class="keyword">...</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="60,74" id="srcline74"> 74</a></span><span class="line"><span class="comment">%         {'real','integer','nonnegative','finite','size', [2, 1]}, <span class="keyword">...</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="60,75" id="srcline75"> 75</a></span><span class="line"><span class="comment">%         [class(obj) '.' propName], propName);  </span></span></span>
<span class="srcline"><span class="lineno"><a href="60,76" id="srcline76"> 76</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="60,77" id="srcline77"> 77</a></span><span class="line">    obj.NumGuardBandCarriers = guardBands;</span></span>
<span class="srcline"><span class="lineno"><a href="60,78" id="srcline78"> 78</a></span><span class="line">  <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="60,79" id="srcline79"> 79</a></span><span class="line">  </span></span>
<span class="srcline"><span class="lineno"><a href="60,80" id="srcline80"> 80</a></span><span class="line">  <span class="keyword">function</span> set.NumSymbols(obj, numSym)</span></span>
<span class="srcline"><span class="lineno"><a href="60,81" id="srcline81"> 81</a></span><span class="line">    propName = <span class="string">'NumSymbols'</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="60,82" id="srcline82"> 82</a></span><span class="line"><span class="comment">%     validateattributes(numSym, {'numeric'}, <span class="keyword">...</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="60,83" id="srcline83"> 83</a></span><span class="line"><span class="comment">%         {'real','scalar','integer','positive','finite'}, <span class="keyword">...</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="60,84" id="srcline84"> 84</a></span><span class="line"><span class="comment">%         [class(obj) '.' propName], propName);  </span></span></span>
<span class="srcline"><span class="lineno"><a href="60,85" id="srcline85"> 85</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="60,86" id="srcline86"> 86</a></span><span class="line">    obj.NumSymbols = numSym;</span></span>
<span class="srcline"><span class="lineno"><a href="60,87" id="srcline87"> 87</a></span><span class="line">  <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="60,88" id="srcline88"> 88</a></span><span class="line">  </span></span>
<span class="srcline"><span class="lineno"><a href="60,89" id="srcline89"> 89</a></span><span class="line">  <span class="keyword">function</span> set.PilotCarrierIndices(obj, pilotIdx)</span></span>
<span class="srcline"><span class="lineno"><a href="60,90" id="srcline90"> 90</a></span><span class="line">    propName = <span class="string">'PilotCarrierIndices'</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="60,91" id="srcline91"> 91</a></span><span class="line"><span class="comment">%     validateattributes(pilotIdx, {'numeric'}, <span class="keyword">...</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="60,92" id="srcline92"> 92</a></span><span class="line"><span class="comment">%         {'real','integer','positive','finite','3d'}, <span class="keyword">...</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="60,93" id="srcline93"> 93</a></span><span class="line"><span class="comment">%         [class(obj) '.' propName], propName);  </span></span></span>
<span class="srcline"><span class="lineno"><a href="60,94" id="srcline94"> 94</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="60,95" id="srcline95"> 95</a></span><span class="line">    <span class="comment">% Check the 3rd dimension for numTx</span></span></span>
<span class="srcline"><span class="lineno"><a href="60,96" id="srcline96"> 96</a></span><span class="line">    coder.internal.errorIf((ndims(pilotIdx) == 3) &amp;&amp; (size(pilotIdx, 3) &gt; 64), <span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="60,97" id="srcline97"> 97</a></span><span class="line">        <span class="string">'comm.OFDM.xxx'</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="60,98" id="srcline98"> 98</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="60,99" id="srcline99"> 99</a></span><span class="line">    numPilotPerSym = numel(pilotIdx)/size(pilotIdx,2);</span></span>
<span class="srcline"><span class="lineno"><a href="60,100" id="srcline100">100</a></span><span class="line">    <span class="keyword">for</span> symIdx = 1:size(pilotIdx, 2)</span></span>
<span class="srcline"><span class="lineno"><a href="60,101" id="srcline101">101</a></span><span class="line">        pilotIdxPerSym = pilotIdx(:,symIdx,:);        </span></span>
<span class="srcline"><span class="lineno"><a href="60,102" id="srcline102">102</a></span><span class="line">        coder.internal.errorIf( numPilotPerSym ~= length(unique(pilotIdxPerSym(:))) , <span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="60,103" id="srcline103">103</a></span><span class="line">            <span class="string">'comm:OFDM:xxx'</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="60,104" id="srcline104">104</a></span><span class="line">        <span class="comment">% Error message: </span></span></span>
<span class="srcline"><span class="lineno"><a href="60,105" id="srcline105">105</a></span><span class="line">        <span class="comment">% If pilot index is 2-D, the indices per symbol must be unique;</span></span></span>
<span class="srcline"><span class="lineno"><a href="60,106" id="srcline106">106</a></span><span class="line">        <span class="comment">% If pilot index is 3-D, the indices across transmit antennas per symbol must be unique.</span></span></span>
<span class="srcline"><span class="lineno"><a href="60,107" id="srcline107">107</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="60,108" id="srcline108">108</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="60,109" id="srcline109">109</a></span><span class="line">    obj.PilotCarrierIndices = pilotIdx;</span></span>
<span class="srcline"><span class="lineno"><a href="60,110" id="srcline110">110</a></span><span class="line">  <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="60,111" id="srcline111">111</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="60,112" id="srcline112">112</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="60,113" id="srcline113">113</a></span><span class="line"><span class="keyword">methods</span>(Access = protected)  </span></span>
<span class="srcline"><span class="lineno"><a href="60,114" id="srcline114">114</a></span><span class="line">  <span class="keyword">function</span> s = saveObjectImpl(obj)</span></span>
<span class="srcline"><span class="lineno"><a href="60,115" id="srcline115">115</a></span><span class="line">    s = saveObjectImpl@matlab.System(obj);</span></span>
<span class="srcline"><span class="lineno"><a href="60,116" id="srcline116">116</a></span><span class="line">    <span class="keyword">if</span> isLocked(obj)</span></span>
<span class="srcline"><span class="lineno"><a href="60,117" id="srcline117">117</a></span><span class="line">        s.pDataLinearIndices  = obj.pDataLinearIndices;</span></span>
<span class="srcline"><span class="lineno"><a href="60,118" id="srcline118">118</a></span><span class="line">        s.pPilotLinearIndices = obj.pPilotLinearIndices; </span></span>
<span class="srcline"><span class="lineno"><a href="60,119" id="srcline119">119</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="60,120" id="srcline120">120</a></span><span class="line">  <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="60,121" id="srcline121">121</a></span><span class="line">  </span></span>
<span class="srcline"><span class="lineno"><a href="60,122" id="srcline122">122</a></span><span class="line">  <span class="keyword">function</span> loadObjectImpl(obj, s, wasLocked)</span></span>
<span class="srcline"><span class="lineno"><a href="60,123" id="srcline123">123</a></span><span class="line">    <span class="keyword">if</span> (wasLocked)</span></span>
<span class="srcline"><span class="lineno"><a href="60,124" id="srcline124">124</a></span><span class="line">        obj.pDataLinearIndices  = s.pDataLinearIndices;</span></span>
<span class="srcline"><span class="lineno"><a href="60,125" id="srcline125">125</a></span><span class="line">        obj.pPilotLinearIndices = s.pPilotLinearIndices; </span></span>
<span class="srcline"><span class="lineno"><a href="60,126" id="srcline126">126</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="60,127" id="srcline127">127</a></span><span class="line">    loadObjectImpl@matlab.System(obj, s);</span></span>
<span class="srcline"><span class="lineno"><a href="60,128" id="srcline128">128</a></span><span class="line">  <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="60,129" id="srcline129">129</a></span><span class="line">  </span></span>
<span class="srcline"><span class="lineno"><a href="60,130" id="srcline130">130</a></span><span class="line">  <span class="keyword">function</span> dependentPropertyValidation(obj, hasPilot, hasDCNull)</span></span>
<span class="srcline"><span class="lineno"><a href="60,131" id="srcline131">131</a></span><span class="line">    FFTLen     = obj.FFTLength;</span></span>
<span class="srcline"><span class="lineno"><a href="60,132" id="srcline132">132</a></span><span class="line">    halfFFTLen = obj.FFTLength/2;</span></span>
<span class="srcline"><span class="lineno"><a href="60,133" id="srcline133">133</a></span><span class="line">    numSym     = obj.NumSymbols;</span></span>
<span class="srcline"><span class="lineno"><a href="60,134" id="srcline134">134</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="60,135" id="srcline135">135</a></span><span class="line">    <span class="comment">% Cyclic prefix</span></span></span>
<span class="srcline"><span class="lineno"><a href="60,136" id="srcline136">136</a></span><span class="line">    CPLen = obj.CyclicPrefixLength;    </span></span>
<span class="srcline"><span class="lineno"><a href="60,137" id="srcline137">137</a></span><span class="line">    coder.internal.errorIf( <span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="60,138" id="srcline138">138</a></span><span class="line">        (~isscalar(CPLen) &amp;&amp; (length(CPLen) ~= numSym)) || any(CPLen&gt;FFTLen), <span class="string">'comm:OFDM:xxx'</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="60,139" id="srcline139">139</a></span><span class="line">        </span></span>
<span class="srcline"><span class="lineno"><a href="60,140" id="srcline140">140</a></span><span class="line">    <span class="comment">% Guard bands</span></span></span>
<span class="srcline"><span class="lineno"><a href="60,141" id="srcline141">141</a></span><span class="line">    guardBand = obj.NumGuardBandCarriers;</span></span>
<span class="srcline"><span class="lineno"><a href="60,142" id="srcline142">142</a></span><span class="line">    coder.internal.errorIf(any(guardBand &gt;= halfFFTLen), <span class="string">'comm:OFDM:xxx'</span>);    </span></span>
<span class="srcline"><span class="lineno"><a href="60,143" id="srcline143">143</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="60,144" id="srcline144">144</a></span><span class="line">    <span class="comment">% Pilot indices</span></span></span>
<span class="srcline"><span class="lineno"><a href="60,145" id="srcline145">145</a></span><span class="line">    <span class="keyword">if</span> hasPilot</span></span>
<span class="srcline"><span class="lineno"><a href="60,146" id="srcline146">146</a></span><span class="line">        pilotIdx = obj.PilotCarrierIndices;        </span></span>
<span class="srcline"><span class="lineno"><a href="60,147" id="srcline147">147</a></span><span class="line">        numPilotPerSym = size(pilotIdx, 1); <span class="comment">% Number of pilots per symbol</span></span></span>
<span class="srcline"><span class="lineno"><a href="60,148" id="srcline148">148</a></span><span class="line">        coder.internal.errorIf( <span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="60,149" id="srcline149">149</a></span><span class="line">            (numPilotPerSym &gt;= FFTLen) || <span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="60,150" id="srcline150">150</a></span><span class="line">            ((size(pilotIdx, 2) ~= 1) &amp;&amp; (size(pilotIdx, 2) ~= numSym)) || <span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="60,151" id="srcline151">151</a></span><span class="line">            <span class="keyword">...</span><span class="comment"> <span class="comment">% The 3rd dimension is checked in OFDM Modulator only</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="60,152" id="srcline152">152</a></span><span class="line">            any(pilotIdx(:) &lt; (guardBand(1)+1)) || <span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="60,153" id="srcline153">153</a></span><span class="line">            any(pilotIdx(:) &gt; (FFTLen-guardBand(2))) || <span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="60,154" id="srcline154">154</a></span><span class="line">            any(pilotIdx(:) == halfFFTLen+1), <span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="60,155" id="srcline155">155</a></span><span class="line">            <span class="string">'comm:OFDM:xxx'</span>);        </span></span>
<span class="srcline"><span class="lineno"><a href="60,156" id="srcline156">156</a></span><span class="line">        </span></span>
<span class="srcline"><span class="lineno"><a href="60,157" id="srcline157">157</a></span><span class="line">        numPilotAllTxPerSym = numel(pilotIdx)/size(pilotIdx, 2); <span class="comment">% i.e., pilots + custom nulls</span></span></span>
<span class="srcline"><span class="lineno"><a href="60,158" id="srcline158">158</a></span><span class="line">    <span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="60,159" id="srcline159">159</a></span><span class="line">        numPilotAllTxPerSym = 0;        </span></span>
<span class="srcline"><span class="lineno"><a href="60,160" id="srcline160">160</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="60,161" id="srcline161">161</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="60,162" id="srcline162">162</a></span><span class="line">    <span class="comment">% Length check for total guard band carriers, null carriers and pilot carriers</span></span></span>
<span class="srcline"><span class="lineno"><a href="60,163" id="srcline163">163</a></span><span class="line">    coder.internal.errorIf(<span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="60,164" id="srcline164">164</a></span><span class="line">        (sum(guardBand) + hasDCNull + numPilotAllTxPerSym) &gt;= FFTLen, <span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="60,165" id="srcline165">165</a></span><span class="line">        <span class="string">'comm:OFDM:xxx'</span>);          </span></span>
<span class="srcline"><span class="lineno"><a href="60,166" id="srcline166">166</a></span><span class="line">  <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="60,167" id="srcline167">167</a></span><span class="line">  </span></span>
<span class="srcline"><span class="lineno"><a href="60,168" id="srcline168">168</a></span><span class="line">  <span class="keyword">function</span> linearIdx = convert3DIndexToLinearIndex(obj, IdxIn3D)</span></span>
<span class="srcline"><span class="lineno"><a href="60,169" id="srcline169">169</a></span><span class="line">    FFTLen = obj.FFTLength;</span></span>
<span class="srcline"><span class="lineno"><a href="60,170" id="srcline170">170</a></span><span class="line">    num1stDim = size(IdxIn3D, 1);</span></span>
<span class="srcline"><span class="lineno"><a href="60,171" id="srcline171">171</a></span><span class="line">    num2ndDim = size(IdxIn3D, 2);</span></span>
<span class="srcline"><span class="lineno"><a href="60,172" id="srcline172">172</a></span><span class="line">    num3rdDim = size(IdxIn3D, 3);</span></span>
<span class="srcline"><span class="lineno"><a href="60,173" id="srcline173">173</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="60,174" id="srcline174">174</a></span><span class="line">    expanded2ndDimIdx = repmat(1:num2ndDim, [num1stDim 1 num3rdDim]);</span></span>
<span class="srcline"><span class="lineno"><a href="60,175" id="srcline175">175</a></span><span class="line">    expanded3rdDimIdx = repmat(1:num3rdDim, [num1stDim*num2ndDim 1]);</span></span>
<span class="srcline"><span class="lineno"><a href="60,176" id="srcline176">176</a></span><span class="line">    linearIdx = sub2ind([FFTLen num2ndDim num3rdDim], <span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="60,177" id="srcline177">177</a></span><span class="line">        IdxIn3D(:), expanded2ndDimIdx(:), expanded3rdDimIdx(:));</span></span>
<span class="srcline"><span class="lineno"><a href="60,178" id="srcline178">178</a></span><span class="line">  <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="60,179" id="srcline179">179</a></span><span class="line">  </span></span>
<span class="srcline"><span class="lineno"><a href="60,180" id="srcline180">180</a></span><span class="line">  <span class="keyword">function</span> numCarriers = getNumDataCarriers(obj, hasDCNull, hasPilot)</span></span>
<span class="srcline"><span class="lineno"><a href="60,181" id="srcline181">181</a></span><span class="line">    numCarriers = obj.FFTLength - <span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="60,182" id="srcline182">182</a></span><span class="line">      sum(obj.NumGuardBandCarriers) - <span class="keyword">...</span><span class="comment"> <span class="comment">% Guard bands</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="60,183" id="srcline183">183</a></span><span class="line">      hasDCNull - <span class="keyword">...</span><span class="comment">                     <span class="comment">% DC null</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="60,184" id="srcline184">184</a></span><span class="line">      hasPilot*numel(obj.PilotCarrierIndices)/size(obj.PilotCarrierIndices, 2); <span class="comment">% Pilots &amp; Custom nulls</span></span></span>
<span class="srcline"><span class="lineno"><a href="60,185" id="srcline185">185</a></span><span class="line">  <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="60,186" id="srcline186">186</a></span><span class="line">      </span></span>
<span class="srcline"><span class="lineno"><a href="60,187" id="srcline187">187</a></span><span class="line">  <span class="keyword">function</span> frameLen = getTimeDomainFrameLength(obj)</span></span>
<span class="srcline"><span class="lineno"><a href="60,188" id="srcline188">188</a></span><span class="line">    FFTLen = obj.FFTLength;</span></span>
<span class="srcline"><span class="lineno"><a href="60,189" id="srcline189">189</a></span><span class="line">    CPLen  = obj.CyclicPrefixLength;</span></span>
<span class="srcline"><span class="lineno"><a href="60,190" id="srcline190">190</a></span><span class="line">    numSym = obj.NumSymbols;</span></span>
<span class="srcline"><span class="lineno"><a href="60,191" id="srcline191">191</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="60,192" id="srcline192">192</a></span><span class="line">    frameLen = FFTLen*numSym + sum(repmat(CPLen, [1 numSym/length(CPLen)]));</span></span>
<span class="srcline"><span class="lineno"><a href="60,193" id="srcline193">193</a></span><span class="line">  <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="60,194" id="srcline194">194</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="60,195" id="srcline195">195</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="60,196" id="srcline196">196</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="60,197" id="srcline197">197</a></span><span class="line"> </span></span>
</pre>
</div>
